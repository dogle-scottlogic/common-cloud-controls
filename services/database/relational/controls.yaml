common_controls:
  - CCC.C01 # Prevent unencrypted requests
  - CCC.C02 # Ensure data encryption at rest for all stored data
  - CCC.C03 # Implement multi-factor authentication (MFA) for access
  - CCC.C04 # Log all access and changes
  - CCC.C05 # Prevent access from untrusted entities
  - CCC.C06 # Prevent deployment in restricted regions
  - CCC.C07 # Alert on non-human enumeration
  - CCC.C09 # Prevent tampering, deletion, or unauthorized access to access logs
  - CCC.C10 # Prevent data replication to destinations outside of defined trust perimeter

controls:
  - id: CCC.RDMS.C01
    title: Enforce Role-Based Access Control
    objective: Ensure only authorized roles can access database resources.
    control_family: Data
    nist_csf: PR.AC-1
    threats:
      - M1041 # Restrict User Privileges
    control_mappings:
      CCM:
        - IAM-02
        - IAM-12
      ISO_27001:
        - 2013 A.9.1.2
      NIST_800_53:
        - AC-2
    test_requirements:
      - id: CCC.RDMS.C1.TR01
        text: Role-based access control for database management system
        tlp_levels: # TODO Need to confirm these
      - id: CCC.RDMS.C1.TR02
        text: Restrict access to database resources based on role definitions
      - id: CCC.RDMS.C1.TR03
        text: Prevent unauthorized access to database resources

  - id: CCC.RDMS.C02
    title: Disable Access with Default Credentials
    objective: |
      Ensure that default credentials are disabled and only authorized 
      roles can access database resources.
    control_family: Data
    nist_csf: PR.AC-5
    threats:
      - M1041 # Restrict User Privileges
    control_mappings:
      CCM:
        - IAM-09
        - IAM-13
      ISO_27001:
        - 2013 A.9.2.6
      NIST_800_53:
        - AC-17
    test_requirements:
      - id: CCC.RDMS.C2.TR01
        text: Secure Database Access Control

  - id: CCC.RDMS.C03
    title: Restrict Snapshot Collection To Trusted Roles
    objective: Limit snapshot collection capabilities to trusted roles.
    control_family: Data
    nist_csf: PR.DS-3
    threats:
      - M1054 # Restrict Data Access
    control_mappings:
      CCM:
        - DSI-05
        - DSI-07
      ISO_27001:
        - 2013 A.12.3.1
      NIST_800_53:
        - CP-09
    test_requirements:
      - id: CCC.RDMS.C3.TR01
        text: Snapshot collection by trusted roles
      - id: CCC.RDMS.C3.TR02
        text: Restriction of snapshot collection capabilities
      - id: CCC.RDMS.C3.TR03
        text: Prevent unauthorized snapshot collection

  - id: CCC.RDMS.C04
    title: Enforce Logging & Monitoring
    objective: Ensure logging and monitoring cannot be disabled by users.
    control_family: Data
    nist_csf: PR.PT-1
    threats:
      - M1030 # Network Intrusion Detection
    control_mappings:
      CCM:
        - STA-04
        - STA-05
      ISO_27001:
        - 2013 A.12.4.1
      NIST_800_53:
        - AU-2
        - AU-3
    test_requirements:
      - id: CCC.RDMS.C4.TR01
        text: Enable logging for database activities
      - id: CCC.RDMS.C4.TR02
        text: Active monitoring of database resources
      - id: CCC.RDMS.C4.TR03
        text: Restrict users from disabling logging and monitoring
